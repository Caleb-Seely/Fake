<!DOCTYPE html>
<html>
    
<head>
<script>

var group1 = ["undefined"];
var fake;
var reset = 0;
var ansCheck = 0;

function coinSetup() {

  prefer = document.forms[0].coinTotal.value;      
  fake = Math.floor(Math.random()*prefer);
  document.getElementById("initcoin").innerHTML = "You are searching for 1 fake coin in a pile of " + prefer + " coins."; //" Fake is " + fake;
   var x = document.getElementById("Weigh");
   x.style="visibility:visible;";
   var color = ["red" , "blue", "green"];
 
   var click_count = 0;
   var i ;
   var text = "red";
  
  for(i = 0; i < prefer; i++ ){
      //text += "Coin " + i + "<br>";
      let body = document.getElementsByTagName("body")[0];
      let button = document.createElement("button");
      button.innerHTML = +i;
      button.id = "Coin " + i;
      body.appendChild(button);
      body.append(" ");

      button.addEventListener ("click", function() {
         var num = this.innerHTML;
   
         if(reset == 1){      //Only after we have weighed for this round
            hideCoins(num);
         }
         if(ansCheck == 1){
            checkAnswer(num);
         }
                  
         this.style.color= text;
         if(click_count % 3 === 0 ){
            group1[num] = "Blue";
         }
         if(click_count % 3 === 1 ){
            group1[num] = "Green";
         }
         if(click_count % 3 === 2 ){
            group1[num] = "Red";
         }
         click_count++;
         text = color[click_count % 3];
         this.style.background = text;

         
         //alert(this.innerHTML);
      }
      )
  }
  document.getElementById("message").innerHTML = "Here are all the coins <br>Click through them to place them in different piles" ;

  
}

function hideCoins(num){

   var x = document.getElementById("Coin " +num);
   //document.getElementById("message").innerHTML = "Found " + x.id  ;
   var i = 0;
   x.style="visibility:hidden;";
  
}



function weighGroups(){
   
   tmp = document.forms[0].coinTotal.value;
   var text = "";
   var undef = "undefined";
   var result;
   var red = "Red", blue = "Blue", green="Green" ;
   var r = 0, g = 0 , b = 0;
   var err = 0;

   for(var i = 0; i < tmp; i++){          //looks for any spot in array that is undefined
      result = undef.localeCompare(group1[i])  
      if(result == 0){    
            err = 1;                      //Will not proceed with comparrisons if there is an err
      } 
   }

if(err == 0){
   document.getElementById("error").innerHTML = ""
   for(var i = 0; i < tmp; i++){    //Adds up each group
     if(i == fake){
        i++;
     }
      result = red.localeCompare(group1[i]);
      if(result == 0){
         r+=1;
      }
      result = green.localeCompare(group1[i]);
      if(result == 0){
         g+= 1;
      }
      result = blue.localeCompare(group1[i]);
      if(result == 0){
         b +=1;
      }
      
   }

   if(r > b){
      document.getElementById("weighResults").innerHTML="The RED pile weighs more than the BLUE pile"
   }
   if(r < b){
      document.getElementById("weighResults").innerHTML="The BLUE pile weighs more than the RED pile"
   }
   if(r == b){
      document.getElementById("weighResults").innerHTML="The RED pile weighs the same as the BLUE pile"
   }

   var x = document.getElementById("Weigh");
   x.style="visibility:hidden;";

   x = document.getElementById("nextRound")
   x.style="visibility:visible;";
   document.getElementById("Answer").style="visibility:visible;";

   //text += "blue " + b + " red " + r + " green " +g;
   text = "Use this information to narrow down your search for the fake coin. <p>Click on any coin you do not want in the next round before clicking Start next round"
   document.getElementById("message").innerHTML = text;
   reset = 1;
}
else{
   document.getElementById("error").innerHTML = "Please place all coins into a pile. <p>For most efficient results, use an equal number in each pile."
}
   
   
}

function nextRound(){
   reset = 0;
   document.getElementById("nextRound").style="visibility:hidden;";
   document.getElementById("Weigh").style="visibility:visible;";
}

function checkAnswer(ans){

   
   if(ans == fake){
      document.getElementById("Answers").innerHTML = "You are correct!";
      document.getElementById("Answer").style="visibility:hidden;";
      document.getElementById("nextRound").style="visibility:hidden;";
   }
   else{
      document.getElementById("Answers").innerHTML = "No that is not the correct coin.";
      reset = 1;
   }
}

function setAnsSelection(){
   document.getElementById("Answers").innerHTML = "Select the fake";
   ansCheck = 1;
   reset = 0;
}

</script>
</head>
<h1>The Fake Coin Problem</h1>
<h2>Using Divide and Conquer</h2>
<body>
  

<form>
How many coins do you want to search through?
  <select id="coinTotal" onchange="coinSetup()">
   <option value="0"></option>
    <option value="3">3</option>
    <option value="9">9</option>
    <option value="27">27</option>
    <option value="30">30</option>
  </select>
</form>

<p id="initcoin"></p>
<p id="weighResults"></p>
<p id="message"></p>
<p id="message2"></p>
<p id="message3"></p>

<p id="Answers"></p>
</p>
<p id="error"></p>
<input style="visibility:hidden;" type="button" id="Weigh" value="Weigh groups" onclick="weighGroups()">
<input style="visibility:hidden;" type="button" id="nextRound" value="Start next round" onclick="nextRound()">
<input style="visibility:hidden;" type="button" id="Answer" value="I know the fake!" onclick="setAnsSelection()">
</body>
</html>